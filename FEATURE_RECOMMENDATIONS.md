# 追加機能の提案

## 現在の実装状況

### ✅ 実装済み
- テクニカル分析（RSI、MACD、移動平均線）
- ファンダメンタルズ分析（PER、PBR、ROE、配当利回り、財務健全性）
- 総合分析（テクニカル + ファンダメンタルズ）
- 複数銘柄比較
- 投資期間別ランキング

---

## 🎯 推奨追加機能

### 1. 高度なテクニカル指標

#### ボリンジャーバンド
**用途**: ボラティリティと価格レンジの分析
**実装の価値**: ★★★★★
```
- 上限・下限バンドで買われすぎ/売られすぎを判断
- バンド幅でボラティリティを測定
- スクイーズ（バンド縮小）から大きな動きを予測
```

**使用例**:
```
「トヨタ自動車のボリンジャーバンドを分析して、今が買い時か教えてください」
```

#### ストキャスティクス
**用途**: 買われすぎ/売られすぎの判定
**実装の価値**: ★★★★☆
```
- RSIよりも敏感な指標
- %Kと%Dのクロスでシグナル判定
- 逆張り戦略に有効
```

#### ATR（Average True Range）
**用途**: ボラティリティ測定、ストップロス設定
**実装の価値**: ★★★★☆
```
- リスク管理に不可欠
- 適切な損切りラインの設定
- ポジションサイズの決定
```

#### 一目均衡表
**用途**: 日本発のテクニカル指標、トレンド分析
**実装の価値**: ★★★★★（日本株に最適）
```
- 転換線、基準線、先行スパン、遅行スパン
- 雲の厚さでサポート/レジスタンスの強度
- 日本市場で広く使われている
```

#### フィボナッチ・リトレースメント
**用途**: サポート/レジスタンスレベルの予測
**実装の価値**: ★★★☆☆
```
- 価格の反発ポイント予測
- 目標価格の設定
```

---

### 2. より詳細なファンダメンタルズ分析

#### キャッシュフロー分析
**実装の価値**: ★★★★★
```
- 営業キャッシュフロー
- 投資キャッシュフロー
- 財務キャッシュフロー
- フリーキャッシュフロー
→ 実際の資金繰りを評価
```

**使用例**:
```
「ソフトバンクグループのキャッシュフロー健全性を評価してください」
```

#### 成長性指標
**実装の価値**: ★★★★★
```
- 売上高成長率（YoY、3年平均）
- 利益成長率（YoY、3年平均）
- EPS成長率
- 設備投資比率
→ 企業の成長力を評価
```

#### セクター比較
**実装の価値**: ★★★★★
```
- 同業他社との比較
- セクター平均との比較
- 業界ランキング
→ 相対的な優位性を評価
```

**使用例**:
```
「トヨタ自動車を自動車セクター内で比較分析してください」
```

#### 配当分析の強化
**実装の価値**: ★★★★☆
```
- 配当性向
- 連続増配年数
- 配当成長率
- 配当の安定性
→ 配当投資家向け
```

#### アナリスト評価
**実装の価値**: ★★★☆☆
```
- 目標株価
- 推奨レーティング
- コンセンサス予想
→ 市場の見方を把握
```

---

### 3. リスク管理機能

#### ベータ値分析
**実装の価値**: ★★★★☆
```
- 市場全体との連動性
- リスク調整後リターン
- ポートフォリオのリスク分散評価
```

#### ドローダウン分析
**実装の価値**: ★★★★☆
```
- 最大ドローダウン（最大下落率）
- 回復期間
- ドローダウン頻度
→ 下落リスクの把握
```

#### シャープレシオ
**実装の価値**: ★★★★☆
```
- リスク調整後リターンの評価
- 投資効率の測定
```

#### バリュー・アット・リスク（VaR）
**実装の価値**: ★★★☆☆
```
- 最悪シナリオの損失予測
- リスク量の定量化
```

---

### 4. ポートフォリオ管理

#### ポートフォリオ最適化
**実装の価値**: ★★★★★
```
- 効率的フロンティア
- 最適資産配分
- リバランス提案
```

**使用例**:
```
「以下の銘柄で、リスクを最小化しつつリターンを最大化する配分比率を教えてください:
7203, 6758, 9984, 8306, 9432」
```

#### セクター分散分析
**実装の価値**: ★★★★☆
```
- セクター別ウェイト
- 分散度合いの評価
- セクター偏りの警告
```

#### 相関分析
**実装の価値**: ★★★★☆
```
- 銘柄間の相関係数
- 分散効果の測定
- ヘッジに適した銘柄の提案
```

---

### 5. アラート・監視機能

#### 価格アラート
**実装の価値**: ★★★★★
```
- 目標価格到達通知
- ストップロス到達通知
- 急騰・急落アラート
```

**使用例**:
```
「トヨタ自動車が3,000円を超えたら教えてください」
```

#### テクニカルシグナルアラート
**実装の価値**: ★★★★★
```
- ゴールデンクロス発生通知
- RSI買われすぎ/売られすぎ通知
- ボリンジャーバンド突破通知
```

#### 決算発表通知
**実装の価値**: ★★★★☆
```
- 決算日のリマインダー
- 業績予想との比較
- サプライズの検出
```

---

### 6. ニュース・センチメント分析

#### ニュース取得
**実装の価値**: ★★★★★
```
- 関連ニュースの取得
- 重要度の評価
- ポジティブ/ネガティブ判定
```

**使用例**:
```
「トヨタ自動車の最近のニュースを分析して、株価への影響を教えてください」
```

#### SNSセンチメント分析
**実装の価値**: ★★★☆☆
```
- Twitter/掲示板の感情分析
- 注目度の測定
- センチメント変化の検出
```

---

### 7. スクリーニング機能

#### カスタムスクリーナー
**実装の価値**: ★★★★★
```
複数条件での銘柄抽出
```

**使用例**:
```
「以下の条件を満たす銘柄を探してください:
- PER < 15
- ROE > 10%
- 配当利回り > 3%
- 時価総額 > 1兆円」
```

#### テーマ別スクリーニング
**実装の価値**: ★★★★☆
```
- 高配当株
- グロース株（成長株）
- バリュー株（割安株）
- ディフェンシブ株
- 小型成長株
```

---

### 8. バックテスト機能

#### 戦略のバックテスト
**実装の価値**: ★★★★☆
```
- 過去データでの検証
- パフォーマンス測定
- 最適パラメータの探索
```

**使用例**:
```
「RSI 30以下で買い、70以上で売る戦略を過去1年でバックテストしてください」
```

---

### 9. マクロ経済指標連携

#### 経済指標との相関分析
**実装の価値**: ★★★★☆
```
- 金利、為替、商品価格との関連
- 日銀政策との連動性
- GDP、雇用統計の影響
```

**使用例**:
```
「トヨタ自動車の株価と円ドル為替レートの相関を分析してください」
```

---

### 10. レポート生成機能

#### PDF/Excel レポート出力
**実装の価値**: ★★★★★
```
- 分析結果のPDF出力
- グラフ付きレポート
- Excelでのデータ出力
```

#### 定期レポート
**実装の価値**: ★★★★☆
```
- 週次/月次レポート自動生成
- ポートフォリオサマリー
- パフォーマンスレビュー
```

---

## 🎯 優先順位付けの推奨

### 最優先（すぐに実装すべき）★★★★★

1. **ボリンジャーバンド** - 実用性が高く、需要が多い
2. **一目均衡表** - 日本株に特化した指標
3. **キャッシュフロー分析** - 財務健全性の本質的評価
4. **セクター比較** - 相対評価に不可欠
5. **ポートフォリオ最適化** - 実用的な資産配分
6. **カスタムスクリーナー** - 銘柄発掘に必須
7. **ニュース取得** - タイムリーな情報

### 高優先（次に実装すべき）★★★★☆

8. **ストキャスティクス**
9. **ATR（ボラティリティ）**
10. **成長性指標の強化**
11. **配当分析の強化**
12. **ベータ値・リスク指標**
13. **相関分析**
14. **価格アラート**

### 中優先（余裕があれば）★★★☆☆

15. **フィボナッチ・リトレースメント**
16. **アナリスト評価**
17. **バリュー・アット・リスク**
18. **SNSセンチメント**
19. **バックテスト機能**

---

## 💡 実装の提案

### Phase 1: テクニカル指標の拡充
```typescript
// ボリンジャーバンド
interface BollingerBands {
  upper: number[];
  middle: number[];
  lower: number[];
  bandwidth: number;
  signal: 'SQUEEZE' | 'EXPANSION' | 'NORMAL';
}

// 一目均衡表
interface IchimokuCloud {
  tenkan: number;    // 転換線
  kijun: number;     // 基準線
  senkou_a: number;  // 先行スパンA
  senkou_b: number;  // 先行スパンB
  chikou: number;    // 遅行スパン
  signal: 'BULLISH' | 'BEARISH' | 'NEUTRAL';
}
```

### Phase 2: ファンダメンタルズの深化
```typescript
interface CashFlowAnalysis {
  operatingCashFlow: number;
  investingCashFlow: number;
  financingCashFlow: number;
  freeCashFlow: number;
  fcfMargin: number;
  cashConversion: number;
  rating: 'EXCELLENT' | 'GOOD' | 'FAIR' | 'POOR';
}

interface GrowthMetrics {
  revenueGrowth1Y: number;
  revenueGrowth3Y: number;
  profitGrowth1Y: number;
  profitGrowth3Y: number;
  epsGrowth: number;
  rating: 'HIGH_GROWTH' | 'MODERATE_GROWTH' | 'LOW_GROWTH' | 'DECLINING';
}
```

### Phase 3: スクリーニング
```typescript
interface ScreeningCriteria {
  per?: { min?: number; max?: number };
  pbr?: { min?: number; max?: number };
  roe?: { min?: number; max?: number };
  dividendYield?: { min?: number; max?: number };
  marketCap?: { min?: number; max?: number };
  sector?: string[];
}

// 使用例
async screenStocks(criteria: ScreeningCriteria): Promise<string[]>
```

### Phase 4: ポートフォリオ最適化
```typescript
interface PortfolioOptimization {
  symbols: string[];
  weights: number[];        // 最適配分比率
  expectedReturn: number;   // 期待リターン
  risk: number;            // リスク（標準偏差）
  sharpeRatio: number;     // シャープレシオ
}
```

---

## 🚀 クイックWin（すぐに価値を出せる機能）

### 1. ボリンジャーバンド（1-2時間で実装可能）
```python
def calculate_bollinger_bands(prices, period=20, std_dev=2):
    sma = prices.rolling(period).mean()
    std = prices.rolling(period).std()
    upper = sma + (std * std_dev)
    lower = sma - (std * std_dev)
    return upper, sma, lower
```

### 2. セクター情報取得（30分で実装可能）
```python
ticker = yf.Ticker("7203.T")
sector = ticker.info.get('sector')
industry = ticker.info.get('industry')
```

### 3. 成長率計算（1時間で実装可能）
```python
# 売上成長率
revenue_growth = (current_revenue - previous_revenue) / previous_revenue * 100
```

---

## まとめ

**今すぐ実装すべきTOP 5:**

1. 🎯 **ボリンジャーバンド** - テクニカル分析の強化
2. 📊 **セクター比較機能** - 相対評価
3. 💰 **キャッシュフロー分析** - 財務の深堀り
4. 🔍 **カスタムスクリーナー** - 銘柄発掘
5. 📈 **成長性指標** - 将来性の評価

これらを実装すれば、**プロレベルの株式分析ツール**になります！
